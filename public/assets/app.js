angular.module("app",["ngRoute","ui.router"]),angular.module("app").run(["$http","$window",function(e,t){e.defaults.headers.common["x-auth"]=t.sessionStorage.user_token}]),angular.module("app").controller("adminCtrl",["$scope","$http","auth","$location","$timeout",function(e,t,o,n,r){e.loading=!0,e.setup=function(){t.get("/api/users").then(function(t){e.model=t.data,e.loading=!1},function(t){401==t.status&&(e.authFail=!0,r(function(){n.path("/login")},3e3))})},e.setup(),e.logout=function(){o.logout()}}]),angular.module("app").controller("loginCtrl",["$scope","auth","$location","$timeout",function(e,t,o,n){console.log("login controller"),e.authFail=!1,e.login=function(o,r){t.login(o,r).then(function(e){t.storeToken(e.data,function(){t.getUser().then(function(e){t.postLoginOps(e.data,function(){t.postLoginRouteHandler()})})})})["catch"](function(t){console.error("Gists error",t.status,t.data),401==t.status&&(e.authFail=!0,n(function(){e.authFail=!1},3e3))})["finally"](function(){console.log("finally finished gists")})}}]),angular.module("app").controller("masterCtrl",["$scope","$rootScope","$route",function(e,t,o){console.log("masterCtrl"),localStorage.getItem("logged_user")&&(t.currentUser=localStorage.getItem("logged_user")),e.$on("login",function(o,n){console.log("Logged In"),e.currentUser=n,t.currentUser=n,localStorage.setItem("logged_user",t.currentUser.username)})}]),angular.module("app").controller("registerCtrl",["$scope","auth","$location",function(e,t,o){e.register=function(n,r,l){t.register(n,r,l).then(function(n){t.login(r,l),e.$emit("login",n.data),o.path("/admin")})["catch"](function(e){console.log(e)})}}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/"),e.state("app",{url:"/",views:{content:{templateUrl:"/landing.html",controller:"userRegisterCtrl"}}}).state("login",{url:"/login",views:{content:{templateUrl:"/login.html",controller:"loginCtrl"}}}).state("register",{url:"/efb82ec7a1a0e477a33e209dacd2a1e0",views:{content:{templateUrl:"/register.html",controller:"registerCtrl"}}}).state("admin",{url:"/admin",views:{nav:{templateUrl:"/nav.html",controller:"adminCtrl"},content:{templateUrl:"/admin.html",controller:"adminCtrl"}}}),o.html5Mode(!0)}]),angular.module("app").controller("userRegisterCtrl",["$scope","$http",function(e,t){e.setup=function(){e.model={}},e.setup(),e.saveUser=function(){console.log("inside the func"),t.post("/api/users",{name:e.model.name,phone:e.model.phone,email:e.model.email}).then(function(t){console.log(t),$("#thanks").show().delay(5e3).fadeOut(),e.setup()},function(e){console.log(e)})},console.log("here in landing")}]),angular.module("app").service("auth",["$http","$window","$location","$rootScope",function(e,t,o,n){function r(){return e.get("api/admin")}function l(t,o){return e.post("api/sessions",{username:t,password:o})}function a(t,o,n){return e.post("api/admin",{name:t,username:o,password:n})}function i(){localStorage.removeItem("user_token"),localStorage.removeItem("logged_user"),t.sessionStorage.removeItem("user_token"),delete e.defaults.headers.common["x-auth"],n.isLogged=!1,n.currentUser=null,o.path("/login")}function u(o,n){t.sessionStorage.user_token=o,localStorage.setItem("user_token",o),e.defaults.headers.common["x-auth"]=t.sessionStorage.user_token,n&&"function"==typeof n&&n()}function s(){}function c(e,t){n.currentUser=e.name,localStorage.setItem("logged_user",n.currentUser),n.isLogged=!0,t&&"function"==typeof t&&t()}function g(){n.intendedRoute?o.path(n.intendedRoute):o.path("/admin")}return{getUser:r,login:l,register:a,logout:i,storeToken:u,isLogged:s,postLoginOps:c,postLoginRouteHandler:g}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2FkbWluQ3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21hc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9yb3V0ZXMuanMiLCJjb250cm9sbGVycy91c2VyUmVnaXN0ZXJDdHJsLmpzIiwic2VydmljZXMvYXV0aC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJGh0dHAiLCIkd2luZG93IiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwic2Vzc2lvblN0b3JhZ2UiLCJ1c2VyX3Rva2VuIiwiY29udHJvbGxlciIsIiRzY29wZSIsImF1dGgiLCIkbG9jYXRpb24iLCIkdGltZW91dCIsImxvYWRpbmciLCJzZXR1cCIsImdldCIsInRoZW4iLCJyZXNwb25zZSIsIm1vZGVsIiwiZGF0YSIsInN0YXR1cyIsImF1dGhGYWlsIiwicGF0aCIsImxvZ291dCIsImNvbnNvbGUiLCJsb2ciLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJyZXMiLCJzdG9yZVRva2VuIiwiZ2V0VXNlciIsInBvc3RMb2dpbk9wcyIsInBvc3RMb2dpblJvdXRlSGFuZGxlciIsImVycm9yIiwiJHJvb3RTY29wZSIsIiRyb3V0ZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJjdXJyZW50VXNlciIsIiRvbiIsIl8iLCJ1c2VyIiwic2V0SXRlbSIsInJlZ2lzdGVyIiwibmFtZSIsIiRlbWl0IiwiZXJyIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIm90aGVyd2lzZSIsInN0YXRlIiwidXJsIiwidmlld3MiLCJjb250ZW50IiwidGVtcGxhdGVVcmwiLCJuYXYiLCJodG1sNU1vZGUiLCJzYXZlVXNlciIsInBvc3QiLCJwaG9uZSIsImVtYWlsIiwiJCIsInNob3ciLCJkZWxheSIsImZhZGVPdXQiLCJzZXJ2aWNlIiwicmVtb3ZlSXRlbSIsImlzTG9nZ2VkIiwiY2IiLCJpbnRlbmRlZFJvdXRlIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFVBQUEsY0FFQUQsUUFBQUMsT0FBQSxPQUNBQyxLQUFBLFFBQUEsVUFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxTQUFBQyxRQUFBQyxPQUFBLFVBQUFILEVBQUFJLGVBQUFDLGNDTEFULFFBQUFDLE9BQUEsT0FDQVMsV0FBQSxhQUFBLFNBQUEsUUFBQSxPQUFBLFlBQUEsV0FBQSxTQUFBQyxFQUFBUixFQUFBUyxFQUFBQyxFQUFBQyxHQUVBSCxFQUFBSSxTQUFBLEVBQ0FKLEVBQUFLLE1BQUEsV0FFQWIsRUFBQWMsSUFBQSxjQUNBQyxLQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLE1BQUFELEVBQUFFLEtBQ0FWLEVBQUFJLFNBQUEsR0FFQSxTQUFBSSxHQUdBLEtBQUFBLEVBQUFHLFNBQ0FYLEVBQUFZLFVBQUEsRUFDQVQsRUFBQSxXQUFBRCxFQUFBVyxLQUFBLFdBQUEsU0FPQWIsRUFBQUssUUFHQUwsRUFBQWMsT0FBQSxXQUNBYixFQUFBYSxhQzNCQXpCLFFBQUFDLE9BQUEsT0FDQVMsV0FBQSxhQUFBLFNBQUEsT0FBQSxZQUFBLFdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQVksUUFBQUMsSUFBQSxvQkFDQWhCLEVBQUFZLFVBQUEsRUFDQVosRUFBQWlCLE1BQUEsU0FBQUMsRUFBQUMsR0FDQWxCLEVBQUFnQixNQUFBQyxFQUFBQyxHQUNBWixLQUFBLFNBQUFhLEdBQ0FuQixFQUFBb0IsV0FBQUQsRUFBQVYsS0FBQSxXQUNBVCxFQUFBcUIsVUFDQWYsS0FBQSxTQUFBYSxHQUNBbkIsRUFBQXNCLGFBQUFILEVBQUFWLEtBQUEsV0FDQVQsRUFBQXVCLGdDQU5BdkIsU0FZQSxTQUFBTyxHQUNBTyxRQUFBVSxNQUFBLGNBQUFqQixFQUFBRyxPQUFBSCxFQUFBRSxNQUNBLEtB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LFVBTUEsUUFBQVEsR0FBQUQsRUFBQTBDLEdBQ0FyRSxFQUFBSSxlQUFBLFdBQUF1QixFQUNBUSxhQUFBTSxRQUFBLGFBQUFkLEdBQ0E1QixFQUFBRSxTQUFBQyxRQUFBQyxPQUFBLFVBQUFILEVBQUFJLGVBQUFDLFdBQ0FnRSxHQUFBLGtCQUFBQSxJQUNBQSxJQUlBLFFBQUFELE1BSUEsUUFBQXRDLEdBQUFILEVBQUEwQyxHQUdBcEMsRUFBQUksWUFBQVYsRUFBQWdCLEtBQ0FSLGFBQUFNLFFBQUEsY0FBQVIsRUFBQUksYUFDQUosRUFBQW1DLFVBQUEsRUFDQUMsR0FBQSxrQkFBQUEsSUFDQUEsSUFLQSxRQUFBdEMsS0FDQUUsRUFBQXFDLGNBQ0E3RCxFQUFBVyxLQUFBYSxFQUFBcUMsZUFFQTdELEVBQUFXLEtBQUEsVUE1RUEsT0FDQVMsUUFBQUEsRUFDQUwsTUFBQUEsRUFDQWtCLFNBQUFBLEVBQ0FyQixPQUFBQSxFQUNBTyxXQUFBQSxFQUNBd0MsU0FBQUEsRUFDQXRDLGFBQUFBLEVBQ0FDLHNCQUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICduZ1JvdXRlJywgJ3VpLnJvdXRlcidcbl0pXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAucnVuKFsnJGh0dHAnLCAnJHdpbmRvdycsIGZ1bmN0aW9uKCRodHRwLCAkd2luZG93KSB7XG4gICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9ICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudXNlcl90b2tlblxuICAgIH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoLCAkbG9jYXRpb24sICR0aW1lb3V0KSB7XG5cbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuc2V0dXAgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kZWwgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2FsbGVkIGFzeW5jaHJvbm91c2x5IGlmIGFuIGVycm9yIG9jY3Vyc1xuICAgICAgICAgICAgICAgICAgICAvLyBvciBzZXJ2ZXIgcmV0dXJucyByZXNwb25zZSB3aXRoIGFuIGVycm9yIHN0YXR1cy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdXRoRmFpbCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKSB9LCAzMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zZXR1cCgpO1xuXG5cbiAgICAgICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXV0aC5sb2dvdXQoKVxuICAgICAgICB9XG5cbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgYXV0aCwgJGxvY2F0aW9uLCAkdGltZW91dCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImxvZ2luIGNvbnRyb2xsZXJcIilcbiAgICAgICAgJHNjb3BlLmF1dGhGYWlsID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICAgICAgYXV0aC5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGF1dGguc3RvcmVUb2tlbihyZXMuZGF0YSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoLmdldFVzZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLnBvc3RMb2dpbk9wcyhyZXMuZGF0YSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLnBvc3RMb2dpblJvdXRlSGFuZGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dpc3RzIGVycm9yJywgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdXRoRmFpbCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyAkc2NvcGUuYXV0aEZhaWwgPSBmYWxzZTsgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmFsbHkgZmluaXNoZWQgZ2lzdHNcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdtYXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkcm91dGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJtYXN0ZXJDdHJsXCIpO1xuXG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkX3VzZXInKSkgeyAgICAgICAgICBcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkX3VzZXInKVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24oXywgdXNlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2dnZWQgSW5cIik7XG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZF91c2VyJywgJHJvb3RTY29wZS5jdXJyZW50VXNlci51c2VybmFtZSlcbiAgICAgICAgfSlcbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJyxmdW5jdGlvbigkc2NvcGUsYXV0aCwkbG9jYXRpb24pe1xuXHQkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbihuYW1lLHVzZXJuYW1lLHBhc3N3b3JkKXtcblx0XHRhdXRoLnJlZ2lzdGVyKG5hbWUsdXNlcm5hbWUscGFzc3dvcmQpXG5cdFx0LnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1x0XHRcdFxuXHRcdFx0YXV0aC5sb2dpbih1c2VybmFtZSxwYXNzd29yZClcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLHJlc3BvbnNlLmRhdGEpXG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnL2FkbWluJylcblx0XHR9KVxuXHRcdC5jYXRjaChmdW5jdGlvbiAoZXJyKXtcblx0XHRcdGNvbnNvbGUubG9nKGVycilcblx0XHR9KVxuXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2xhbmRpbmcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndXNlclJlZ2lzdGVyQ3RybCdcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuXG4gICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgICAgIHVybDogJy9lZmI4MmVjN2ExYTBlNDc3YTMzZTIwOWRhY2QyYTFlMCcsXG4gICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3JlZ2lzdGVyQ3RybCdcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICAuc3RhdGUoJ2FkbWluJywge1xuICAgICAgICAgICAgdXJsOiAnL2FkbWluJyxcbiAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgJ25hdic6e1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9uYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhZG1pbkN0cmwnXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ2NvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FkbWluLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsJ1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG5cblxuXG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpXG5cblxuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ3VzZXJSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgICAgICRzY29wZS5zZXR1cCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLm1vZGVsID0ge307XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLnNldHVwKCk7XG4gICAgICAgICRzY29wZS5zYXZlVXNlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbnNpZGUgdGhlIGZ1bmNcIilcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICRzY29wZS5tb2RlbC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBwaG9uZTogJHNjb3BlLm1vZGVsLnBob25lLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogJHNjb3BlLm1vZGVsLmVtYWlsXG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuICAgICAgICAgICAgICAgICAgICAkKFwiI3RoYW5rc1wiKS5zaG93KCkuZGVsYXkoNTAwMCkuZmFkZU91dCgpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXR1cCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiaGVyZSBpbiBsYW5kaW5nXCIpXG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5zZXJ2aWNlKCdhdXRoJywgZnVuY3Rpb24oJGh0dHAsICR3aW5kb3csICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFVzZXI6IGdldFVzZXIsXG4gICAgICAgICAgICBsb2dpbjogbG9naW4sXG4gICAgICAgICAgICByZWdpc3RlcjogcmVnaXN0ZXIsXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgICAgICAgIHN0b3JlVG9rZW46IHN0b3JlVG9rZW4sXG4gICAgICAgICAgICBpc0xvZ2dlZDogaXNMb2dnZWQsXG4gICAgICAgICAgICBwb3N0TG9naW5PcHM6IHBvc3RMb2dpbk9wcyxcbiAgICAgICAgICAgIHBvc3RMb2dpblJvdXRlSGFuZGxlcjogcG9zdExvZ2luUm91dGVIYW5kbGVyXG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFVzZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdhcGkvYWRtaW4nKVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvc2Vzc2lvbnMnLCB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKG5hbWUsIHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXG4gICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9hZG1pbicsIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyX3Rva2VuJyk7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbG9nZ2VkX3VzZXInKTtcbiAgICAgICAgICAgICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcl90b2tlbicpO1xuICAgICAgICAgICAgZGVsZXRlICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXVxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKVxuXG5cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RvcmVUb2tlbihyZXMsIGNiKSB7XG4gICAgICAgICAgICAkd2luZG93LnNlc3Npb25TdG9yYWdlW1widXNlcl90b2tlblwiXSA9IHJlc1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJfdG9rZW4nLCByZXMpO1xuICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS51c2VyX3Rva2VuXG4gICAgICAgICAgICBpZiAoY2IgJiYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNMb2dnZWQoKSB7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHBvc3RMb2dpbk9wcyhyZXMsIGNiKSB7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5uYW1lXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbG9nZ2VkX3VzZXInLCAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKVxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2dlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoY2IgJiYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwb3N0TG9naW5Sb3V0ZUhhbmRsZXIoKSB7XG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pbnRlbmRlZFJvdXRlKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJHJvb3RTY29wZS5pbnRlbmRlZFJvdXRlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hZG1pbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuXG4gICAgfSlcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
